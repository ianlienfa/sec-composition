<dds xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
     xsi:noNamespaceSchemaLocation="http://www.omg.org/spec/DDS-SECURITY/20170901/omg_shared_ca_permissions.xsd">
  <permissions>
    <grant name="/remote_listener">
      <subject_name>CN=/remote_listener</subject_name>
      <validity>
        <not_before>2024-01-01T00:00:00</not_before>
        <not_after>2035-01-01T00:00:00</not_after>
      </validity>
      <allow_rule>
        <domains>
          <id>0</id>
        </domains>

        <!-- Allow all publishing and subscribing on any topic -->
        <publish>
          <topics>
            <topic>*</topic>
          </topics>
        </publish>
        <subscribe>
          <topics>
            <topic>rt/shout</topic>
          </topics>
        </subscribe>

        <!-- Allow all services -->
        <publish>
          <topics>
            <topic>rq/*</topic>
            <topic>rr/*</topic>
            <topic>rt/*</topic>
          </topics>
        </publish>
        <subscribe>
          <topics>
            <topic>rq/*</topic>
            <topic>rr/*</topic>
            <topic>rt/*</topic>
          </topics>
        </subscribe>

        <!-- Required for ROS 2 & DDS discovery -->
        <publish>
          <topics>
            <topic>DCPS*</topic>
            <topic>ros_discovery_info</topic>
          </topics>
        </publish>
        <subscribe>
          <topics>
            <topic>DCPS*</topic>
            <topic>ros_discovery_info</topic>
          </topics>
        </subscribe>
      </allow_rule>

      <!-- Allow everything else implicitly -->
      <default>DENY</default>
    </grant>
  </permissions>
</dds>